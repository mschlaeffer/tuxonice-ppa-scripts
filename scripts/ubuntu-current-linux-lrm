#!/bin/bash

RELEASE=$1
KERNEL=`ubuntu-release2kernel $RELEASE`

lynx -dump https://launchpad.net/ubuntu/$RELEASE/+source/linux-restricted-modules | \
  grep -e \]linux-restricted-modules\  -e ^"   Release" -e "   Security" -e "   Updates" -e "   Proposed" | \
  sed -e 's/^ *//g' -e "s/^[ +]*[[0-9]*]linux-restricted-modules //g" -e 'y/RSUP/rsup/' | \
  sed ':a;N;$!ba;s/\([a-z]\)\n/\1 /g' | \
  awk '{print $2 " " $1}'

lynx -dump http://launchpad.net/~tuxonice/+archive/ppa/+packages | \
  grep -A 1 -i -e "\[package-source\] linux-restricted-modules" | \
  grep -v "\[package-source\] linux-restricted-modules" | \
  sed -e "s/.*\($KERNEL.[.~+0-9a-z-]*\) .*/\1 ppa:tuxonice\/ppa/"

lynx -dump http://launchpad.net/~tuxonice/+archive/tuxonice-testing/+packages | \
  grep -A 1 -i -e "\[package-source\] linux-restricted-modules" | \
  grep -v "\[package-source\] linux-restricted-modules" | \
  sed -e "s/.*\($KERNEL.[.~+0-9a-z-]*\) .*/\1 ppa:tuxonice\/tuxonice-testing/"

